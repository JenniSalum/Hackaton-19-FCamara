import { FormEvent, useContext, useState } from "react";
import toast from "react-hot-toast";
import { Link, useHistory } from "react-router-dom";
import { Input } from "../../components/Input";
import { UserContext } from "../../Context/UserContext";
import { api } from "../../services/api";
import styles from "./styles.module.scss";

export const Login = () => {
  const [email, setEmail] = useState("");
  const [password, setPassword] = useState("");
  const history = useHistory();
  const userContext = useContext(UserContext);
  const handleLogin = async (e: FormEvent) => {
    e.preventDefault();
    try {
      const response = await api.post(`sessions`, { email, password });
      const userData = response.data.user;
      const token = response.data.token;

      userContext?.storeData({ name: userData.name, email: userData.email });
      window.localStorage.setItem("fcalendartoken", token);

      history.push("/home");
    } catch {
      toast.error("Senha ou email inválidos!");
    }
  };
  return (
    <div className={styles.container}>
      <aside>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="400"
          height="400"
          viewBox="0 0 151 33.794"
          className={styles.logo}
        >
          <g id="fcamara" transform="translate(0.5 17.5)">
            <path
              id="União_1"
              data-name="União 1"
              d="M-1089,101.4A16.4,16.4,0,0,1-1072.6,85h16.4v16.4a16.4,16.4,0,0,1-16.4,16.4A16.4,16.4,0,0,1-1089,101.4Zm11.828-10.584v21.2a1.623,1.623,0,0,0,1.619,1.649,1.613,1.613,0,0,0,1.649-1.649v-8.935h7.287a1.537,1.537,0,0,0,1.562-1.562,1.548,1.548,0,0,0-1.562-1.532h-7.287V92.2h9.543a1.555,1.555,0,0,0,1.561-1.562,1.549,1.549,0,0,0-1.561-1.533h-11.163A1.718,1.718,0,0,0-1077.172,90.813Zm123.222,17.871c0-2.777,1.879-5.09,6.94-5.09a16.13,16.13,0,0,1,4.858.868v-.839c0-2.372-1.619-3.962-4.511-3.962a6.3,6.3,0,0,0-3.818,1.418,1.5,1.5,0,0,1-2.053-.232,1.546,1.546,0,0,1,.347-2.053,8.791,8.791,0,0,1,5.755-1.966c4.627,0,7.4,2.314,7.4,6.8v8.329a1.586,1.586,0,0,1-1.591,1.59,1.555,1.555,0,0,1-1.533-1.59v-.665c-1.185,1.678-3.672,2.429-5.7,2.429C-951.521,113.716-953.951,111.836-953.951,108.684Zm2.978,0c0,1.215,1.013,2.227,3.182,2.227,1.677,0,4.367-.636,5.638-2.342l-.029-1.591a17.6,17.6,0,0,0-4.829-.838C-950.336,106.14-950.972,107.585-950.972,108.684Zm-32.967,0c0-2.777,1.88-5.09,6.941-5.09a16.134,16.134,0,0,1,4.858.868v-.839c0-2.372-1.62-3.962-4.512-3.962a6.3,6.3,0,0,0-3.817,1.418,1.5,1.5,0,0,1-2.053-.232,1.546,1.546,0,0,1,.346-2.053,8.791,8.791,0,0,1,5.755-1.966c4.627,0,7.4,2.314,7.4,6.8v8.329a1.586,1.586,0,0,1-1.59,1.59,1.555,1.555,0,0,1-1.533-1.59v-.665c-1.185,1.678-3.673,2.429-5.7,2.429C-981.51,113.716-983.939,111.836-983.939,108.684Zm2.979,0c0,1.215,1.012,2.227,3.181,2.227,1.678,0,4.4-.636,5.639-2.342l-.029-1.591A17.607,17.607,0,0,0-977,106.14C-980.324,106.14-980.96,107.585-980.96,108.684Zm-50.2,0c0-2.777,1.88-5.09,6.941-5.09a16.135,16.135,0,0,1,4.858.868v-.839c0-2.372-1.619-3.962-4.512-3.962a6.3,6.3,0,0,0-3.817,1.418,1.5,1.5,0,0,1-2.053-.232,1.546,1.546,0,0,1,.347-2.053,8.791,8.791,0,0,1,5.755-1.966c4.628,0,7.4,2.314,7.4,6.8v8.329a1.586,1.586,0,0,1-1.59,1.59,1.555,1.555,0,0,1-1.533-1.59v-.665c-1.185,1.678-3.673,2.429-5.7,2.429C-1028.734,113.716-1031.163,111.836-1031.163,108.684Zm2.979,0c0,1.215,1.012,2.227,3.181,2.227,1.678,0,4.367-.636,5.639-2.342l-.029-1.591a17.608,17.608,0,0,0-4.829-.838C-1027.548,106.14-1028.184,107.585-1028.184,108.684Zm-25.13-7.259A12.127,12.127,0,0,1-1041.2,89.164a11.647,11.647,0,0,1,7.952,2.979,1.653,1.653,0,0,1,.174,2.255,1.642,1.642,0,0,1-2.285.174,8.661,8.661,0,0,0-5.841-2.284,8.963,8.963,0,0,0-8.879,9.166,8.939,8.939,0,0,0,8.879,9.139,8.713,8.713,0,0,0,5.841-2.285,1.641,1.641,0,0,1,2.285.174,1.653,1.653,0,0,1-.174,2.255,11.647,11.647,0,0,1-7.952,2.979A12.151,12.151,0,0,1-1053.314,101.425Zm63.389,10.555V104.2c0-2.66-1.388-4.309-3.7-4.309-2.66-.029-4.309,2.024-4.309,4.714v7.316a1.586,1.586,0,0,1-1.59,1.59,1.58,1.58,0,0,1-1.561-1.59v-7.75c0-2.661-1.388-4.338-3.5-4.338-2.255,0-4.511,1.388-4.511,4.8v7.316a1.586,1.586,0,0,1-1.591,1.59,1.58,1.58,0,0,1-1.562-1.59V98.591a1.58,1.58,0,0,1,1.562-1.59,1.586,1.586,0,0,1,1.591,1.59V99.6a5.841,5.841,0,0,1,4.482-2.777,6.95,6.95,0,0,1,1.764.116,5.175,5.175,0,0,1,4.222,3.238,5.954,5.954,0,0,1,5.611-3.326c4.048,0,6.246,2.632,6.246,7.172v7.952a1.586,1.586,0,0,1-1.59,1.59A1.58,1.58,0,0,1-989.925,111.981Zm24.9-.029V98.591A1.58,1.58,0,0,1-963.465,97a1.586,1.586,0,0,1,1.591,1.59v2.227c.839-2.834,2.4-3.991,4.511-3.991,1.186,0,3.124.231,2.834,1.938-.174,1.012-1.07,1.215-2.2,1.1a5.827,5.827,0,0,0-.694-.029c-3.123,0-4.453,3.326-4.453,7.635v4.482a1.586,1.586,0,0,1-1.591,1.59A1.58,1.58,0,0,1-965.027,111.952Zm20.388-18.71a4.515,4.515,0,0,1-1.273-.925,3.919,3.919,0,0,1-.809-1.33,4.011,4.011,0,0,1-.29-1.533,4.076,4.076,0,0,1,.319-1.562,4.514,4.514,0,0,1,.839-1.33,4.124,4.124,0,0,1,1.272-.925,3.79,3.79,0,0,1,1.62-.346,3.346,3.346,0,0,1,1.619.375,3.677,3.677,0,0,1,1.244.955,4.842,4.842,0,0,1,.809,1.33,4,4,0,0,1,.29,1.533,4.05,4.05,0,0,1-.29,1.561,4.937,4.937,0,0,1-.838,1.33,4.124,4.124,0,0,1-1.273.925,4.705,4.705,0,0,1-1.59.289A3.825,3.825,0,0,1-944.639,93.242Zm.579-6.362a2.269,2.269,0,0,0-.752.636,3.126,3.126,0,0,0-.463.868,6.765,6.765,0,0,0-.115,1.04,3.285,3.285,0,0,0,.173,1.041,2.768,2.768,0,0,0,.464.868,2.181,2.181,0,0,0,.752.607,2.264,2.264,0,0,0,1.013.231,2.263,2.263,0,0,0,1.012-.231,2.279,2.279,0,0,0,.752-.636,2.923,2.923,0,0,0,.463-.9,2.973,2.973,0,0,0,.144-1.012,3.282,3.282,0,0,0-.173-1.04,2.785,2.785,0,0,0-.463-.868,2.589,2.589,0,0,0-.752-.608,2.264,2.264,0,0,0-1.013-.231A2.488,2.488,0,0,0-944.06,86.88Zm-18.826,6.362a3.173,3.173,0,0,1-1.128-.9,3.387,3.387,0,0,1-.607-1.3,6.776,6.776,0,0,1-.2-1.533V85.318h1.59v4.193a5.749,5.749,0,0,0,.087,1.012,1.989,1.989,0,0,0,.346.839,3.037,3.037,0,0,0,.607.607,2.1,2.1,0,0,0,.955.2,1.937,1.937,0,0,0,.954-.231,1.831,1.831,0,0,0,.636-.607,2.684,2.684,0,0,0,.346-.839,3.642,3.642,0,0,0,.087-.983V85.318h1.59v4.193a5.7,5.7,0,0,1-.2,1.59,3.919,3.919,0,0,1-.636,1.3,2.815,2.815,0,0,1-1.128.868,4.042,4.042,0,0,1-1.619.318A3.691,3.691,0,0,1-962.887,93.242Zm-18.305.029a3.8,3.8,0,0,1-1.244-.9,4.171,4.171,0,0,1-.839-1.33,4.521,4.521,0,0,1-.318-1.649,4.217,4.217,0,0,1,.318-1.59,4.373,4.373,0,0,1,.839-1.3,4.048,4.048,0,0,1,1.273-.9,3.638,3.638,0,0,1,1.59-.318,3.915,3.915,0,0,1,2,.491,3.166,3.166,0,0,1,1.244,1.3l-1.186.868a2.066,2.066,0,0,0-.868-.925,2.532,2.532,0,0,0-1.214-.319,2.106,2.106,0,0,0-.954.231,2.184,2.184,0,0,0-.752.607,2.5,2.5,0,0,0-.463.868,4.141,4.141,0,0,0-.174,1.041,3.18,3.18,0,0,0,.174,1.069,2.181,2.181,0,0,0,.52.868,1.976,1.976,0,0,0,.781.579,2.09,2.09,0,0,0,.954.2,2.789,2.789,0,0,0,2.14-1.128v-.579h-1.649V89.309h2.979v4.222h-1.33v-.925a3.111,3.111,0,0,1-2.284.983A3.925,3.925,0,0,1-981.192,93.271Zm26.316-7.952h3.469a2.489,2.489,0,0,1,1.041.231,2.571,2.571,0,0,1,.839.636,3.363,3.363,0,0,1,.549.868,2.391,2.391,0,0,1,.2.983,2.971,2.971,0,0,1-.174,1.012,2.666,2.666,0,0,1-.52.868,2.378,2.378,0,0,1-.81.607,2.489,2.489,0,0,1-1.04.232h-1.938V93.5l-1.619.029Zm1.619,4.077h1.85a.878.878,0,0,0,.724-.347,1.6,1.6,0,0,0,.289-.984,1.567,1.567,0,0,0-.086-.549,1.55,1.55,0,0,0-.231-.434,1,1,0,0,0-.347-.26,1.046,1.046,0,0,0-.434-.087h-1.793ZM-968.7,93.531l-1.677-2.747h-1.562v2.747h-1.62V85.318h3.644a2.492,2.492,0,0,1,1.041.231,2.568,2.568,0,0,1,.838.636,3.368,3.368,0,0,1,.55.868,2.391,2.391,0,0,1,.2.983,2.8,2.8,0,0,1-.4,1.446,2.431,2.431,0,0,1-1.07.954l1.88,3.094Zm-3.238-4.135h2a.669.669,0,0,0,.405-.115,1,1,0,0,0,.318-.29,1.51,1.51,0,0,0,.231-.433,1.648,1.648,0,0,0,.087-.521,1.4,1.4,0,0,0-.087-.52,1.315,1.315,0,0,0-.26-.434,3.086,3.086,0,0,0-.347-.29,1.02,1.02,0,0,0-.4-.086h-1.938Z"
              transform="translate(1089 -102)"
              fill="#fe4400"
              stroke="rgba(0,0,0,0)"
              strokeWidth="1"
            />
          </g>
        </svg>
        <h2>O seu sistema para agendamentos.</h2>
      </aside>
      <main>
        <div className={styles.mainContent}>
          <form className={styles.form} onSubmit={handleLogin}>
            <h2>Login</h2>
            <Input
              id={"email"}
              type={"email"}
              setValue={setEmail}
              value={email}
              placeholder={"Insira o seu email"}
              required
            />
            <Input
              id={"password"}
              type={"password"}
              setValue={setPassword}
              value={password}
              placeholder={"Insira a sua senha"}
              required
            />
            <Link to="#" className={styles.forgetPassword}>
              {" "}
              Esqueceu a sua senha?
            </Link>
            <button type="submit">Entrar</button>
            <br />
            <Link to="/signUp">Primeiro Acesso</Link>
          </form>

          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="200"
            height="200"
            viewBox="0 0 151 33.794"
            className={styles.logoFCamara}
          >
            <g id="fcamara" transform="translate(0.5 17.5)">
              <path
                id="União_1"
                data-name="União 1"
                d="M-1089,101.4A16.4,16.4,0,0,1-1072.6,85h16.4v16.4a16.4,16.4,0,0,1-16.4,16.4A16.4,16.4,0,0,1-1089,101.4Zm11.828-10.584v21.2a1.623,1.623,0,0,0,1.619,1.649,1.613,1.613,0,0,0,1.649-1.649v-8.935h7.287a1.537,1.537,0,0,0,1.562-1.562,1.548,1.548,0,0,0-1.562-1.532h-7.287V92.2h9.543a1.555,1.555,0,0,0,1.561-1.562,1.549,1.549,0,0,0-1.561-1.533h-11.163A1.718,1.718,0,0,0-1077.172,90.813Zm123.222,17.871c0-2.777,1.879-5.09,6.94-5.09a16.13,16.13,0,0,1,4.858.868v-.839c0-2.372-1.619-3.962-4.511-3.962a6.3,6.3,0,0,0-3.818,1.418,1.5,1.5,0,0,1-2.053-.232,1.546,1.546,0,0,1,.347-2.053,8.791,8.791,0,0,1,5.755-1.966c4.627,0,7.4,2.314,7.4,6.8v8.329a1.586,1.586,0,0,1-1.591,1.59,1.555,1.555,0,0,1-1.533-1.59v-.665c-1.185,1.678-3.672,2.429-5.7,2.429C-951.521,113.716-953.951,111.836-953.951,108.684Zm2.978,0c0,1.215,1.013,2.227,3.182,2.227,1.677,0,4.367-.636,5.638-2.342l-.029-1.591a17.6,17.6,0,0,0-4.829-.838C-950.336,106.14-950.972,107.585-950.972,108.684Zm-32.967,0c0-2.777,1.88-5.09,6.941-5.09a16.134,16.134,0,0,1,4.858.868v-.839c0-2.372-1.62-3.962-4.512-3.962a6.3,6.3,0,0,0-3.817,1.418,1.5,1.5,0,0,1-2.053-.232,1.546,1.546,0,0,1,.346-2.053,8.791,8.791,0,0,1,5.755-1.966c4.627,0,7.4,2.314,7.4,6.8v8.329a1.586,1.586,0,0,1-1.59,1.59,1.555,1.555,0,0,1-1.533-1.59v-.665c-1.185,1.678-3.673,2.429-5.7,2.429C-981.51,113.716-983.939,111.836-983.939,108.684Zm2.979,0c0,1.215,1.012,2.227,3.181,2.227,1.678,0,4.4-.636,5.639-2.342l-.029-1.591A17.607,17.607,0,0,0-977,106.14C-980.324,106.14-980.96,107.585-980.96,108.684Zm-50.2,0c0-2.777,1.88-5.09,6.941-5.09a16.135,16.135,0,0,1,4.858.868v-.839c0-2.372-1.619-3.962-4.512-3.962a6.3,6.3,0,0,0-3.817,1.418,1.5,1.5,0,0,1-2.053-.232,1.546,1.546,0,0,1,.347-2.053,8.791,8.791,0,0,1,5.755-1.966c4.628,0,7.4,2.314,7.4,6.8v8.329a1.586,1.586,0,0,1-1.59,1.59,1.555,1.555,0,0,1-1.533-1.59v-.665c-1.185,1.678-3.673,2.429-5.7,2.429C-1028.734,113.716-1031.163,111.836-1031.163,108.684Zm2.979,0c0,1.215,1.012,2.227,3.181,2.227,1.678,0,4.367-.636,5.639-2.342l-.029-1.591a17.608,17.608,0,0,0-4.829-.838C-1027.548,106.14-1028.184,107.585-1028.184,108.684Zm-25.13-7.259A12.127,12.127,0,0,1-1041.2,89.164a11.647,11.647,0,0,1,7.952,2.979,1.653,1.653,0,0,1,.174,2.255,1.642,1.642,0,0,1-2.285.174,8.661,8.661,0,0,0-5.841-2.284,8.963,8.963,0,0,0-8.879,9.166,8.939,8.939,0,0,0,8.879,9.139,8.713,8.713,0,0,0,5.841-2.285,1.641,1.641,0,0,1,2.285.174,1.653,1.653,0,0,1-.174,2.255,11.647,11.647,0,0,1-7.952,2.979A12.151,12.151,0,0,1-1053.314,101.425Zm63.389,10.555V104.2c0-2.66-1.388-4.309-3.7-4.309-2.66-.029-4.309,2.024-4.309,4.714v7.316a1.586,1.586,0,0,1-1.59,1.59,1.58,1.58,0,0,1-1.561-1.59v-7.75c0-2.661-1.388-4.338-3.5-4.338-2.255,0-4.511,1.388-4.511,4.8v7.316a1.586,1.586,0,0,1-1.591,1.59,1.58,1.58,0,0,1-1.562-1.59V98.591a1.58,1.58,0,0,1,1.562-1.59,1.586,1.586,0,0,1,1.591,1.59V99.6a5.841,5.841,0,0,1,4.482-2.777,6.95,6.95,0,0,1,1.764.116,5.175,5.175,0,0,1,4.222,3.238,5.954,5.954,0,0,1,5.611-3.326c4.048,0,6.246,2.632,6.246,7.172v7.952a1.586,1.586,0,0,1-1.59,1.59A1.58,1.58,0,0,1-989.925,111.981Zm24.9-.029V98.591A1.58,1.58,0,0,1-963.465,97a1.586,1.586,0,0,1,1.591,1.59v2.227c.839-2.834,2.4-3.991,4.511-3.991,1.186,0,3.124.231,2.834,1.938-.174,1.012-1.07,1.215-2.2,1.1a5.827,5.827,0,0,0-.694-.029c-3.123,0-4.453,3.326-4.453,7.635v4.482a1.586,1.586,0,0,1-1.591,1.59A1.58,1.58,0,0,1-965.027,111.952Zm20.388-18.71a4.515,4.515,0,0,1-1.273-.925,3.919,3.919,0,0,1-.809-1.33,4.011,4.011,0,0,1-.29-1.533,4.076,4.076,0,0,1,.319-1.562,4.514,4.514,0,0,1,.839-1.33,4.124,4.124,0,0,1,1.272-.925,3.79,3.79,0,0,1,1.62-.346,3.346,3.346,0,0,1,1.619.375,3.677,3.677,0,0,1,1.244.955,4.842,4.842,0,0,1,.809,1.33,4,4,0,0,1,.29,1.533,4.05,4.05,0,0,1-.29,1.561,4.937,4.937,0,0,1-.838,1.33,4.124,4.124,0,0,1-1.273.925,4.705,4.705,0,0,1-1.59.289A3.825,3.825,0,0,1-944.639,93.242Zm.579-6.362a2.269,2.269,0,0,0-.752.636,3.126,3.126,0,0,0-.463.868,6.765,6.765,0,0,0-.115,1.04,3.285,3.285,0,0,0,.173,1.041,2.768,2.768,0,0,0,.464.868,2.181,2.181,0,0,0,.752.607,2.264,2.264,0,0,0,1.013.231,2.263,2.263,0,0,0,1.012-.231,2.279,2.279,0,0,0,.752-.636,2.923,2.923,0,0,0,.463-.9,2.973,2.973,0,0,0,.144-1.012,3.282,3.282,0,0,0-.173-1.04,2.785,2.785,0,0,0-.463-.868,2.589,2.589,0,0,0-.752-.608,2.264,2.264,0,0,0-1.013-.231A2.488,2.488,0,0,0-944.06,86.88Zm-18.826,6.362a3.173,3.173,0,0,1-1.128-.9,3.387,3.387,0,0,1-.607-1.3,6.776,6.776,0,0,1-.2-1.533V85.318h1.59v4.193a5.749,5.749,0,0,0,.087,1.012,1.989,1.989,0,0,0,.346.839,3.037,3.037,0,0,0,.607.607,2.1,2.1,0,0,0,.955.2,1.937,1.937,0,0,0,.954-.231,1.831,1.831,0,0,0,.636-.607,2.684,2.684,0,0,0,.346-.839,3.642,3.642,0,0,0,.087-.983V85.318h1.59v4.193a5.7,5.7,0,0,1-.2,1.59,3.919,3.919,0,0,1-.636,1.3,2.815,2.815,0,0,1-1.128.868,4.042,4.042,0,0,1-1.619.318A3.691,3.691,0,0,1-962.887,93.242Zm-18.305.029a3.8,3.8,0,0,1-1.244-.9,4.171,4.171,0,0,1-.839-1.33,4.521,4.521,0,0,1-.318-1.649,4.217,4.217,0,0,1,.318-1.59,4.373,4.373,0,0,1,.839-1.3,4.048,4.048,0,0,1,1.273-.9,3.638,3.638,0,0,1,1.59-.318,3.915,3.915,0,0,1,2,.491,3.166,3.166,0,0,1,1.244,1.3l-1.186.868a2.066,2.066,0,0,0-.868-.925,2.532,2.532,0,0,0-1.214-.319,2.106,2.106,0,0,0-.954.231,2.184,2.184,0,0,0-.752.607,2.5,2.5,0,0,0-.463.868,4.141,4.141,0,0,0-.174,1.041,3.18,3.18,0,0,0,.174,1.069,2.181,2.181,0,0,0,.52.868,1.976,1.976,0,0,0,.781.579,2.09,2.09,0,0,0,.954.2,2.789,2.789,0,0,0,2.14-1.128v-.579h-1.649V89.309h2.979v4.222h-1.33v-.925a3.111,3.111,0,0,1-2.284.983A3.925,3.925,0,0,1-981.192,93.271Zm26.316-7.952h3.469a2.489,2.489,0,0,1,1.041.231,2.571,2.571,0,0,1,.839.636,3.363,3.363,0,0,1,.549.868,2.391,2.391,0,0,1,.2.983,2.971,2.971,0,0,1-.174,1.012,2.666,2.666,0,0,1-.52.868,2.378,2.378,0,0,1-.81.607,2.489,2.489,0,0,1-1.04.232h-1.938V93.5l-1.619.029Zm1.619,4.077h1.85a.878.878,0,0,0,.724-.347,1.6,1.6,0,0,0,.289-.984,1.567,1.567,0,0,0-.086-.549,1.55,1.55,0,0,0-.231-.434,1,1,0,0,0-.347-.26,1.046,1.046,0,0,0-.434-.087h-1.793ZM-968.7,93.531l-1.677-2.747h-1.562v2.747h-1.62V85.318h3.644a2.492,2.492,0,0,1,1.041.231,2.568,2.568,0,0,1,.838.636,3.368,3.368,0,0,1,.55.868,2.391,2.391,0,0,1,.2.983,2.8,2.8,0,0,1-.4,1.446,2.431,2.431,0,0,1-1.07.954l1.88,3.094Zm-3.238-4.135h2a.669.669,0,0,0,.405-.115,1,1,0,0,0,.318-.29,1.51,1.51,0,0,0,.231-.433,1.648,1.648,0,0,0,.087-.521,1.4,1.4,0,0,0-.087-.52,1.315,1.315,0,0,0-.26-.434,3.086,3.086,0,0,0-.347-.29,1.02,1.02,0,0,0-.4-.086h-1.938Z"
                transform="translate(1089 -102)"
                fill="#fe4400"
                stroke="rgba(0,0,0,0)"
                strokeWidth="1"
              />
            </g>
          </svg>
        </div>
      </main>
    </div>
  );
};
